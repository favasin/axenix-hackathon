var _timer,forEach,stIsIE=!1;sorttable={init:function(){if(arguments.callee.done)return;if(arguments.callee.done=!0,_timer&&clearInterval(_timer),!document.createElement||!document.getElementsByTagName)return;sorttable.DATE_RE=/^(\d\d?)[/.-](\d\d?)[/.-]((\d\d)?\d\d)$/,forEach(document.getElementsByTagName("table"),function(e){e.className.search(/\bsortable\b/)!=-1&&sorttable.makeSortable(e)})},makeSortable:function(e){if(e.getElementsByTagName("thead").length==0&&(the=document.createElement("thead"),the.appendChild(e.rows[0]),e.insertBefore(the,e.firstChild)),e.tHead==null&&(e.tHead=e.getElementsByTagName("thead")[0]),e.tHead.rows.length!=1)return;sortbottomrows=[];for(var t=0;t<e.rows.length;t++)e.rows[t].className.search(/\bsortbottom\b/)!=-1&&(sortbottomrows[sortbottomrows.length]=e.rows[t]);if(sortbottomrows){e.tFoot==null&&(tfo=document.createElement("tfoot"),e.appendChild(tfo));for(t=0;t<sortbottomrows.length;t++)tfo.appendChild(sortbottomrows[t]);delete sortbottomrows}headrow=e.tHead.rows[0].cells;for(t=0;t<headrow.length;t++)headrow[t].className.match(/\bsorttable_nosort\b/)||(mtch=headrow[t].className.match(/\bsorttable_([a-z0-9]+)\b/),mtch&&(override=mtch[1]),mtch&&typeof sorttable["sort_"+override]=="function"?headrow[t].sorttable_sortfunction=sorttable["sort_"+override]:headrow[t].sorttable_sortfunction=sorttable.guessType(e,t),headrow[t].sorttable_columnindex=t,headrow[t].sorttable_tbody=e.tBodies[0],dean_addEvent(headrow[t],"click",sorttable.innerSortFunction=function(){if(this.className.search(/\bsorttable_sorted\b/)!=-1){sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted","sorttable_sorted_reverse"),this.removeChild(document.getElementById("sorttable_sortfwdind")),sortrevind=document.createElement("span"),sortrevind.id="sorttable_sortrevind",sortrevind.innerHTML=stIsIE?'&nbsp<font face="webdings">5</font>':"&nbsp;&#x25B4;",this.appendChild(sortrevind);return}if(this.className.search(/\bsorttable_sorted_reverse\b/)!=-1){sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted_reverse","sorttable_sorted"),this.removeChild(document.getElementById("sorttable_sortrevind")),sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;",this.appendChild(sortfwdind);return}theadrow=this.parentNode,forEach(theadrow.childNodes,function(e){e.nodeType==1&&(e.className=e.className.replace("sorttable_sorted_reverse",""),e.className=e.className.replace("sorttable_sorted",""))}),sortfwdind=document.getElementById("sorttable_sortfwdind"),sortfwdind&&sortfwdind.parentNode.removeChild(sortfwdind),sortrevind=document.getElementById("sorttable_sortrevind"),sortrevind&&sortrevind.parentNode.removeChild(sortrevind),this.className+=" sorttable_sorted",sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;",this.appendChild(sortfwdind),row_array=[],col=this.sorttable_columnindex,rows=this.sorttable_tbody.rows;for(var t=0;t<rows.length;t++)row_array[row_array.length]=[sorttable.getInnerText(rows[t].cells[col]),rows[t]];row_array.sort(this.sorttable_sortfunction),tb=this.sorttable_tbody;for(t=0;t<row_array.length;t++)tb.appendChild(row_array[t][1]);delete row_array}))},guessType:function(e,t){sortfn=sorttable.sort_alpha;for(var n=0;n<e.tBodies[0].rows.length;n++)if(text=sorttable.getInnerText(e.tBodies[0].rows[n].cells[t]),text!=""){if(text.match(/^-?[£$¤]?[\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1]),second=parseInt(possdate[2]),first>12)return sorttable.sort_ddmm;if(second>12)return sorttable.sort_mmdd;sortfn=sorttable.sort_ddmm}}return sortfn},getInnerText:function(e){if(!e)return"";if(hasInputs=typeof e.getElementsByTagName=="function"&&e.getElementsByTagName("input").length,e.getAttribute("sorttable_customkey")!=null)return e.getAttribute("sorttable_customkey");if(typeof e.textContent!="undefined"&&!hasInputs)return e.textContent.replace(/^\s+|\s+$/g,"");if(typeof e.innerText!="undefined"&&!hasInputs)return e.innerText.replace(/^\s+|\s+$/g,"");if(typeof e.text!="undefined"&&!hasInputs)return e.text.replace(/^\s+|\s+$/g,"");switch(e.nodeType){case 3:if(e.nodeName.toLowerCase()=="input")return e.value.replace(/^\s+|\s+$/g,"");case 4:return e.nodeValue.replace(/^\s+|\s+$/g,"");break;case 1:case 11:for(var n="",t=0;t<e.childNodes.length;t++)n+=sorttable.getInnerText(e.childNodes[t]);return n.replace(/^\s+|\s+$/g,"");break;default:return""}},reverse:function(e){newrows=[];for(var t=0;t<e.rows.length;t++)newrows[newrows.length]=e.rows[t];for(t=newrows.length-1;t>=0;t--)e.appendChild(newrows[t]);delete newrows},sort_numeric:function(e,t){return aa=parseFloat(e[0].replace(/[^0-9.-]/g,"")),isNaN(aa)&&(aa=0),bb=parseFloat(t[0].replace(/[^0-9.-]/g,"")),isNaN(bb)&&(bb=0),aa-bb},sort_alpha:function(e,t){return e[0]==t[0]?0:e[0]<t[0]?-1:1},sort_ddmm:function(e,t){return mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],m.length==1&&(m="0"+m),d.length==1&&(d="0"+d),dt1=y+m+d,mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],m.length==1&&(m="0"+m),d.length==1&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},sort_mmdd:function(e,t){return mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],m.length==1&&(m="0"+m),d.length==1&&(d="0"+d),dt1=y+m+d,mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],m.length==1&&(m="0"+m),d.length==1&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},shaker_sort:function(e,t){for(var n,o,i=0,a=e.length-1,s=!0;s;){s=!1;for(n=i;n<a;++n)t(e[n],e[n+1])>0&&(o=e[n],e[n]=e[n+1],e[n+1]=o,s=!0);if(a--,!s)break;for(n=a;n>i;--n)t(e[n],e[n-1])<0&&(o=e[n],e[n]=e[n-1],e[n-1]=o,s=!0);i++}}},document.addEventListener&&document.addEventListener("DOMContentLoaded",sorttable.init,!1),/WebKit/i.test(navigator.userAgent)&&(_timer=setInterval(function(){/loaded|complete/.test(document.readyState)&&sorttable.init()},10)),window.onload=sorttable.init;function dean_addEvent(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=dean_addEvent.guid++),e.events||(e.events={});var s=e.events[t];s||(s=e.events[t]={},e["on"+t]&&(s[0]=e["on"+t])),s[n.$$guid]=n,e["on"+t]=handleEvent}}dean_addEvent.guid=1;function removeEvent(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function handleEvent(e){var t,s,n=!0;e=e||fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event),t=this.events[e.type];for(s in t)this.$$handleEvent=t[s],this.$$handleEvent(e)===!1&&(n=!1);return n}function fixEvent(e){return e.preventDefault=fixEvent.preventDefault,e.stopPropagation=fixEvent.stopPropagation,e}fixEvent.preventDefault=function(){this.returnValue=!1},fixEvent.stopPropagation=function(){this.cancelBubble=!0},Array.forEach||(Array.forEach=function(e,t,n){for(var s=0;s<e.length;s++)t.call(n,e[s],s,e)}),Function.prototype.forEach=function(e,t,n){for(var s in e)typeof this.prototype[s]=="undefined"&&t.call(n,e[s],s,e)},String.forEach=function(e,t,n){Array.forEach(e.split(""),function(s,o){t.call(n,s,o,e)})},forEach=function(e,t,n){if(e){var s=Object;if(e instanceof Function)s=Function;else if(e.forEach instanceof Function){e.forEach(t,n);return}else typeof e=="string"?s=String:typeof e.length=="number"&&(s=Array);s.forEach(e,t,n)}}