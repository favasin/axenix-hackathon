{{ $file := .Get 0 }}
<!-- required viewer script -->
<script src="https://unpkg.com/@bpmn-io/form-js@1.7.3/dist/form-viewer.umd.js"></script>
<!--link rel="stylesheet" href="https://unpkg.com/@bpmn-io/form-js@1.7.3/dist/assets/form-js.css"-->

<style>
    #form {
        max-width: 800px;
    }
</style>

<a href="{{ $file }}" download>Скачать исходный файл формы JSON</a>
<div id="form"></div>

<!-- add your form schema to this script tag alternatively, load it asynchronously from anywhere -->
<script type='text/javascript'>
    window.addEventListener('DOMContentLoaded', (event) => {
        var s1 = '<script type=\"application/form-schema\">' +
                ' { ' +
                '\"schemaVersion\": 1,' +
                '\"exporter\": {' +
                '\"name\": \"form-js\",' +
                '\"version\": \"0.1.0\"' +
                '},';

        var s2 = "";
        const file = '{{ $file }}';
        var rawFile = new XMLHttpRequest();
        rawFile.open("GET", file, false);
        rawFile.onreadystatechange = function () {
            if (rawFile.readyState === 4) {
                if (rawFile.status === 200 || rawFile.status == 0) {
                    s2 = rawFile.responseText.trim();
                    s2 = s2.startsWith('{') ? s2.slice(1) : s2;
                }
            }
        };
        rawFile.send(null);

        $('#form').html(s1 + s2 + "</script>");

        const schema = JSON.parse(
            document.querySelector('[type="application/form-schema"]').textContent
        );

        const container = document.querySelector('#form');

        FormViewer.createForm({
            container,
            schema
        });
    });
</script>